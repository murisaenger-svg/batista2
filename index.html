<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>fuga</title>
  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
    }
    .player {
      width: 40px;
      height: 40px;
      background: lime;
      position: absolute;
    }
    .enemy {
      width: 40px;
      height: 40px;
      background: red;
      position: absolute;
    }
    .door {
      width: 50px;
      height: 80px;
      background: blue;
      position: absolute;
      right: 20px;
      bottom: 20px;
    }
  </style>
</head>
<body>

<div class="player" id="player"></div>
<div class="enemy" id="enemy"></div>
<div class="door" id="door"></div>

<script>
  const player = document.getElementById("player")
  const enemy = document.getElementById("enemy")
  const door = document.getElementById("door")

  let px = 50
  let py = 50

  let ex = 400
  let ey = 200

  const speed = 5
  const enemySpeed = 2

  const keys = {}

  document.addEventListener("keydown", e => keys[e.key] = true)
  document.addEventListener("keyup", e => keys[e.key] = false)

  function colisao(a,b){
    return (
      a.x < b.x + b.w &&
      a.x + a.w > b.x &&
      a.y < b.y + b.h &&
      a.y + a.h > b.y
    )
  }

  function loop(){
    if(keys["w"]) py -= speed
    if(keys["s"]) py += speed
    if(keys["a"]) px -= speed
    if(keys["d"]) px += speed

    if(ex < px) ex += enemySpeed
    if(ex > px) ex -= enemySpeed
    if(ey < py) ey += enemySpeed
    if(ey > py) ey -= enemySpeed

    player.style.left = px + "px"
    player.style.top = py + "px"

    enemy.style.left = ex + "px"
    enemy.style.top = ey + "px"

    const p = {x:px,y:py,w:40,h:40}
    const e = {x:ex,y:ey,w:40,h:40}
    const d = {
      x: door.offsetLeft,
      y: door.offsetTop,
      w: 50,
      h: 80
    }

    if(colisao(p,e)){
      alert("voce morreu")
      location.reload()
    }

    if(colisao(p,d)){
      alert("voce venceu")
      location.reload()
    }

    requestAnimationFrame(loop)
  }

  loop()
</script>

</body>
</html>

